# 專案執行任務清單 (Project Task Ledger)

本文件紀載專案的執行進度與歷史變動，確保開發流程透明且符合追蹤需求。

---

## 1. 已完成任務 (Completed Tasks) - [已交付]

### 1.1 數據預覽與效能優化
- [x] **無限捲動分頁實作**：解決大數據量載入時的瀏覽器卡頓問題，採用 `IntersectionObserver` 進行延遲渲染。
- [x] **數據同步篩選**：確保底部預覽表格與側邊欄篩選條件即時連動。
- [x] **數據量指示器**：在預覽標頭新增「顯示筆數/總過濾筆數」的動態反饋。
- [x] **空數據視覺反饋**：新增「無匹配篩選條件」的提示視圖。

### 1.2 狀態持久化 (Persistence)
- [x] **篩選條件記憶**：切換工作表時保留已選定的篩選參數，並自動移除無效選項。
- [x] **工作表選擇記憶**：切換檔案或重新載入時，優先恢復先前選定的工作表組合。
- [x] **圖表軸向記憶**：跨數據源保留 X 軸與 Y 軸的欄位配置預設值。

### 1.3 統計與分析增強
- [x] **圖表管制界限同步**：趨勢圖中整合顯示 UCL/LCL 管制界限。
- [x] **異常數據高亮**：落在規格之外 (Out of Spec) 的數據點在趨勢圖中自動標示，並放大尺寸以利辨識。
- [x] **目標值標示與分析**：新增目標值 (Target) 設定，並在圖表中以**綠色長-短-長中心線**標示。
- [x] **偏差分析副座標**：趨勢圖新增右側 Y 軸，動態顯示數據對比目標值的**偏離百分比 (%)**。
- [x] **標準差多維分析**：計算並顯示組內 (Within)、組間 (Between) 與總體 (Overall) 變異指標。
- [x] **導出功能強化**：支持篩選後數據的 Excel 二進制轉存 (xlsx)。

### 1.4 UI/UX 與視覺優化
- [x] **主題適配異常標示**：在深色模式下，超出規格的數據點自動切換為**黃色高亮**（淺色模式維持紅色），確保跨主題的視覺警示效果。
- [x] **文檔系統建立**：基於 MECE 原則重構 README.md 與 TASKS.md，更新 UI 內幫助文檔。

---

## 2. 進行中與待優化 (Pending & Future Improvements)

### 2.1 穩定性優化
- [x] **強化錯誤處理**：針對 Excel 非標準格式（如包含貨幣符號、千分位逗號的數值字符串）實作了強健的 `parseNumber` 解析邏輯，並在數據提取層加入 `try-catch` 保護，防止異常格式導致程式崩潰。
- [x] **瀏覽器相容性測試**：已驗證 Chrome/Edge 核心穩定性。針對 Safari 新增了 `-webkit-backdrop-filter` 支援，並為舊版瀏覽器實作了 `IntersectionObserver` 的降級處理方案 (Fallback)，確保在大數據量載入時的基礎可用性。

### 2.2 功能擴充 (提案)
- [ ] **自定義界限設定**：允許使用者直接在圖表上手動拉動調整 UCL/LCL。
- [ ] **報告模板生成**：一鍵生成包含統計數據與圖表的 PDF/HTML 報告頁面。

---
*Last Updated: 2026-01-14*
*Status: Active*
